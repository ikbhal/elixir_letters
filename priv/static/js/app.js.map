{"version":3,"sources":["web/static/js/app.js"],"names":[],"mappings":"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","file":"priv/static/js/app.js","sourcesContent":["import {Socket} from \"phoenix\"\n\nclass App {\n\n  static loadFonts() {\n\n    // Load them fonts before starting...!\n    WebFont.load({\n      custom: {\n        families: ['alphafridgemagnets_regular']\n      },\n      active: function() {\n        // go go go!!\n        App.init()\n      }\n    })\n  }\n\n  static init(){\n    let socket = new Socket(\"/socket\", {\n      logger: (kind, msg, data) => {\n        //console.log(`${kind}: ${msg}`, data)\n      }\n    })\n\n    socket.connect()\n    socket.onClose( e => console.log(\"CLOSE\", e))\n\n    // const $status    = $(\"#status\")\n    // const $messages  = $(\"#messages\")\n    // const $input     = $(\"#message-input\")\n    const $username  = $(\"#username\")\n    const $draggable = $(\".draggable\")\n    const $client_id = this.guid()\n    const $room      = this.get_room()\n    const $container = $(\"#content\")\n\n    const chan = socket.chan(\"rooms:\" + $room,\n      { client_id: $client_id }\n    )\n\n    chan.join().receive(\"ignore\", () => console.log(\"auth error\"))\n               .receive(\"ok\", () => console.log(\"join ok\"))\n               .after(10000, () => console.log(\"Connection interruption\"))\n    chan.onError(e => console.log(\"something went wrong\", e))\n    chan.onClose(e => console.log(\"channel closed\", e))\n\n    let onDrag = function(id,x,y) {\n      chan.push(\"set:position\", {\n        user: $client_id,\n        body: { id: id, x: x, y: y }\n      })\n    }\n\n    let onDragStop = function(id,x,y) {\n      chan.push(\"save:snapshot\", {})\n    }\n\n    const renderer = new PixiLayer($container, chan)\n    const letters_config = get_letters()\n    const lettersManager = new LettersManager(renderer.stage, letters_config, onDrag, onDragStop)\n\n    chan.on(\"join\", msg=>{\n      // console.log(\"join\", msg)\n      lettersManager.setInitialPositions(msg.positions)\n      // $(\"#content\").keydown(function (event){\n      //   //console.log(\"You pressed the key: \", String.fromCharCode(event.keyCode))\n      // })\n      $(\"#letters-container\").show()\n    })\n\n    $(\"#content\").mousemove(function(event) {\n      chan.push(\"mousemove\",\n        {\n          client_id: $client_id,\n          username: $username.val(),\n          x: event.pageX, y: event.pageY\n        }\n      )\n    })\n\n    chan.on(\"mousemove\", msg => {\n      if (msg.client_id != $client_id){\n        console.log(msg)\n        let element = this.find_or_create_cursor(msg.client_id, msg.username)\n        element\n          .css('top', msg.y - 105)\n          .css('left', msg.x - 10)\n          .clearQueue()\n          .stop(true,false)\n          // .hide()\n          //.fadeIn(10)\n          .fadeTo('fast', 1 )\n          .css('display', 'block')\n          .delay(1000).fadeOut(400)\n      }\n    })\n\n    chan.on(\"user_count:update\", msg => {\n      $(\"#user_count\").text(msg.user_count)\n    })\n\n    chan.on(\"update:position\", msg => {\n      if (msg.user != $client_id){\n        lettersManager.move_letter(msg.body.id, msg.body)\n      }\n    })\n\n  }\n\n  static sanitize_id(id) {\n    return encodeURI(id).replace( /(:|\\.|\\?|\\!|\\[|\\]|,)/g, \"\\\\$1\" );\n  }\n\n  static get_room() {\n    let room = window.location[\"hash\"].replace(\"#\",\"\")\n    if (!room.length) { room = \"lobby\" }\n    // console.log(\"room: \", room)\n    return room\n  }\n\n  static guid() {\n    function s4() {\n      return Math.floor((1 + Math\n        .random()) * 0x10000)\n        .toString(16)\n        .substring(1)\n    }\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n      s4() + '-' + s4() + s4() + s4()\n  }\n\n  static find_or_create_cursor(id, username) {\n    let element = $(\"#\" + id)\n    if (!element.length)\n      element =\n        $(\"<div id=\\\"\" + id +\"\\\" class=\\\"mouse\\\"><p class=\\\"name\\\"></p></div>\")\n        .appendTo(\"#content\")\n    element.find( \".name\" ).text(username)\n    return element\n  }\n\n}\n\nclass PixiLayer {\n  constructor(container, chan){\n    this.chan = chan\n    this.renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight, {backgroundColor : 0xffffff}, false, true)\n    this.renderer.view.id = \"letters-container\"\n    container.append(this.renderer.view)\n\n    // create the root of the scene graph\n    this.stage = new PIXI.Container(0x97c56e, true)\n    // add a shiny background...\n    let background = PIXI.Sprite.fromImage('/images/scrabble_board.png')\n    background.scale.set(0.7)\n    this.stage.addChild(background)\n    //\n    this.animate(this.animate, this.renderer,this.stage)\n  }\n\n  animate(animate, renderer, stage) {\n    // for (var i in letters_map) {\n    //   letters_map[i].rotation += Math.random() * (0.1 - 0.001) + 0\n    // }\n    renderer.render(stage)\n    requestAnimationFrame(function(){\n      animate(animate, renderer, stage)\n    })\n  }\n}\n\nclass LettersManager {\n  constructor(stage, letters_config, onDrag, onDragStop){\n    this.stage = stage\n    this.createLetters(letters_config, onDrag, onDragStop)\n  }\n  setInitialPositions(positions){\n    // initialise the letter positions\n    for (var letter in positions){\n      this.move_letter(letter, positions[letter])\n    }\n  }\n  createLetters(letters, onDrag, onDragStop){\n    this.letters_map = {}\n    for (var i in letters)\n    {\n      let id = letters[i]['code'] + '_' +  letters[i]['count']\n      let char = letters[i]['letter']\n      let letter = new Letter(this.stage, id, char, 30, 30, onDrag, onDragStop)\n      this.letters_map[id] = letter\n      // createLetter(id, char, 30, 30) //Math.random() * window.innerWidth, Math.random() * window.innerHeight)\n    }\n    this.letters_map\n  }\n  move_letter(id, position){\n    try {\n      let letter = this.letters_map[id]\n      letter.position(position.x,position.y)\n    } catch (e) {\n      console.log(e)\n    }\n  }\n}\n\nclass Letter {\n  constructor(stage, id, char, x, y, onDrag, onDragStop) {\n    //const colours = [\"#9C2E23\", \"#C5A02F\", \"#002F6B\", \"#3D6F24\",'#cc00ff']\n    const colours = [\"FFFFFF\"]\n\n    function getPoints(char){\n      const points = {\n        1:\"AEIOULNSTR\",\n        2:\"DG\",\n        3:\"BCMP\",\n        4:\"FHVWY\",\n        5:\"K\",\n        8:\"JX\",\n        10:\"QZ\"\n      }\n      for (var i in points) {\n        if (points[i].toLowerCase().indexOf(char.toLowerCase()) != -1) {\n          return i\n        }\n      }\n      return 1\n    }\n\n    this.stage = stage\n    let randomColour = colours[Math.floor(Math.random() * colours.length)];\n    let container = new PIXI.Container()\n    let tile = PIXI.Sprite.fromImage('/images/blank_tile.jpg')\n    tile.scale.x = 0.09\n    tile.scale.y = 0.09\n    let text = new PIXI.Text(char, { font: '26px Arial', fill: randomColour, align: 'center', stroke: '#FFFFFF', strokeThickness: 2 })\n    let value = new PIXI.Text(getPoints(char), { font: '12px Arial', fill: randomColour, align: 'center', stroke: '#FFFFFF', strokeThickness: 1 })\n    container.addChild(tile)\n    container.addChild(value)\n    container.addChild(text)\n    container.interactive = true\n    container.buttonMode = true\n    text.anchor.set(0.5)\n    tile.anchor.set(0.5)\n    value.anchor = new PIXI.Point(-0.9,-0.2)\n    container.id = id\n    container.class = this\n    //container.scale.set(3)\n    container\n        // events for drag start\n        .on('mousedown', this.onDragStart)\n        .on('touchstart', this.onDragStart)\n        // events for drag end\n        .on('mouseup', this.onDragEnd)\n        .on('mouseupoutside', this.onDragEnd)\n        .on('touchend', this.onDragEnd)\n        .on('touchendoutside', this.onDragEnd)\n        // events for drag move\n        .on('mousemove', this.onDragMove)\n        .on('touchmove', this.onDragMove)\n    container.position.x = x\n    container.position.y = y\n    this.letter = container\n    this.stage.addChild(container)\n    this.broadcastDrag = onDrag\n    this.broadcastDragStop = onDragStop\n  }\n  position(x,y){\n    console.log(\"set position: \", x, y);\n    this.letter.position.x = x\n    this.letter.position.y = y\n  }\n  onDragStart(event){\n    // store a reference to the data\n    // the reason for this is because of multitouch\n    // we want to track the movement of this particular touch\n    this.data = event.data\n    this.alpha = 0.5\n    this.dragging = true\n  }\n  onDragEnd(){\n    this.alpha = 1\n    this.dragging = false\n    // set the interaction data to null\n    this.data = null\n    // TODO: Fix this with a js pub/sub solution\n    // Here is a great one http://davidwalsh.name/pubsub-javascript\n    this.class.broadcastDragStop()\n  }\n  onDragMove(){\n    if (this.dragging){\n      var newPosition = this.data.getLocalPosition(this.parent)\n      this.position.x = newPosition.x\n      this.position.y = newPosition.y\n      this.class.broadcastDrag(this.id,newPosition.x,newPosition.y)\n    }\n  }\n}\n\n$( () => App.loadFonts() )\n\nexport default App\n"]}