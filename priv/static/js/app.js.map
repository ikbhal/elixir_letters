{"version":3,"sources":["web/static/js/app.js"],"names":[],"mappings":"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","file":"priv/static/js/app.js","sourcesContent":["import {Socket} from \"phoenix\"\n\nclass App {\n\n  static loadFonts() {\n    // Load them fonts before starting...!\n    WebFont.load({\n      custom: {\n        families: ['rounds_blackregular']\n      },\n      active: function() {\n        // go go go!!\n        App.init()\n      }\n    })\n  }\n\n  static init(){\n    let socket = new Socket(\"/socket\", {\n      logger: (kind, msg, data) => {\n        //console.log(`${kind}: ${msg}`, data)\n      }\n    })\n\n    socket.connect()\n    socket.onClose( e => console.log(\"CLOSE\", e))\n\n    // const $status    = $(\"#status\")\n    // const $messages  = $(\"#messages\")\n    // const $input     = $(\"#message-input\")\n    const $username  = $(\"#username\")\n    const $draggable = $(\".draggable\")\n    const $client_id = this.guid()\n    const $room      = this.get_room()\n    const $container = $(\"#fridge\")\n\n    const chan = socket.chan(\"rooms:\" + $room,\n      { client_id: $client_id }\n    )\n\n    chan.join()\n      .receive(\"ignore\", () => console.log(\"auth error\"))\n      .receive(\"ok\", () => console.log(\"join ok\"))\n      .after(10000, () => console.log(\"Connection interruption\"))\n    chan.onError(e => console.log(\"something went wrong\", e))\n    chan.onClose(e => console.log(\"channel closed\", e))\n\n    let onDrag = function(id,x,y) {\n      chan.push(\"set:position\", {\n        user: $client_id,\n        body: { id: id, x: x, y: y }\n      })\n    }\n\n    let onDragStop = function(id,x,y) {\n      chan.push(\"save:snapshot\", {})\n    }\n\n    // ensure the username input works as expcted\n    $username\n      .keydown(function( event ) {\n        if ( event.which == 13 ) {\n         event.preventDefault()\n         $username.blur()\n        }\n      })\n\n    $container\n      .on('click', function(e) {\n        $username.blur()\n      })\n\n\n    // create the root of the scene graph\n    const stage = new PIXI.Container(0x97c56e, true)\n    const renderer = new PixiLayer($container, chan, stage)\n\n    // add a shiny background...\n    let background = PIXI.Sprite.fromImage('/images/servis.jpg')\n    background.scale.set(0.7)\n    background.anchor.set(0.5)\n    background.position.x = window.innerWidth/2\n    background.position.y = 350 + window.innerHeight/2\n    stage.addChild(background)\n\n    const letters_config = get_letters()\n    const lettersManager = new LettersManager(stage, letters_config, onDrag, onDragStop)\n\n    chan.on(\"join\", msg=>{\n      // console.log(\"join\", msg)\n      lettersManager.setInitialPositions(msg.positions)\n      // $(\"#content\").keydown(function (event){\n      //   //console.log(\"You pressed the key: \", String.fromCharCode(event.keyCode))\n      // })\n      $(\"#letters-container\").show()\n    })\n\n    $(\"#content\").mousemove(function(event) {\n      chan.push(\"mousemove\",\n        {\n          client_id: $client_id,\n          username: $username.val(),\n          x: event.pageX, y: event.pageY\n        }\n      )\n    })\n\n    chan.on(\"mousemove\", msg => {\n      if (msg.client_id != $client_id){\n        // console.log(msg)\n        let element = this.find_or_create_cursor(msg.client_id, msg.username)\n        element\n          .css('top', msg.y - 105)\n          .css('left', msg.x - 10)\n          .clearQueue()\n          .stop(true,false)\n          // .hide()\n          //.fadeIn(10)\n          .fadeTo('fast', 1 )\n          .css('display', 'block')\n          .delay(1000)\n          .fadeOut(400)\n      }\n    })\n\n    chan.on(\"user_count:update\", msg => {\n      $(\"#user_count\").text(msg.user_count)\n    })\n\n    chan.on(\"update:position\", msg => {\n      if (msg.user != $client_id){\n        lettersManager.moveLetter(msg.body.id, msg.body)\n      }\n    })\n\n  }\n\n  static sanitize_id(id) {\n    return encodeURI(id).replace( /(:|\\.|\\?|\\!|\\[|\\]|,)/g, \"\\\\$1\" );\n  }\n\n  static get_room() {\n    let room = window.location[\"hash\"].replace(\"#\",\"\")\n    if (!room.length) { room = \"lobby\" }\n    // console.log(\"room: \", room)\n    return room\n  }\n\n  static guid() {\n    function s4() {\n      return Math.floor((1 + Math\n        .random()) * 0x10000)\n        .toString(16)\n        .substring(1)\n    }\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n      s4() + '-' + s4() + s4() + s4()\n  }\n\n  static find_or_create_cursor(id, username) {\n    let element = $(\"#\" + id)\n    if (!element.length)\n      element =\n        $(\"<div id=\\\"\" + id +\"\\\" class=\\\"mouse\\\"><p class=\\\"name\\\"></p></div>\")\n        .appendTo(\"#content\")\n    element.find( \".name\" ).text(username)\n    return element\n  }\n\n}\n\nclass PixiLayer {\n  constructor(container, chan, stage){\n    this.chan = chan\n    let renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight, {backgroundColor : 0xffffff}, false, true)\n    renderer.view.style.width = window.innerWidth + \"px\"\n  \trenderer.view.style.height = window.innerHeight + \"px\"\n  \trenderer.view.style.display = \"block\"\n\n    renderer.view.id = \"letters-container\"\n    container.append(renderer.view)\n    //\n    this.animate(this.animate, renderer, stage)\n  }\n\n  animate(animate, renderer, stage) {\n    // for (var i in letters_map) {\n    //   letters_map[i].rotation += Math.random() * (0.1 - 0.001) + 0\n    // }\n    renderer.render(stage)\n    requestAnimationFrame(function(){\n      animate(animate, renderer, stage)\n    })\n  }\n}\n\nclass LettersManager {\n  constructor(stage, letters_config, onDrag, onDragStop) {\n    this.stage = stage\n    this.createLetters(letters_config, stage, onDrag, onDragStop)\n  }\n  setInitialPositions(positions) {\n    // initialise the letter positions\n    for (var letter in positions){\n      this.moveLetter(letter, positions[letter])\n    }\n  }\n  createLetters(letters, stage, onDrag, onDragStop) {\n    var letter_map = {}\n    for (var i in letters)\n    {\n      let [id, char] = letters[i]\n      let letter = new Letter(stage, id, char, 30, 30, onDrag, onDragStop, this.randomColour())\n      letter_map[id] = letter\n      // createLetter(id, char, 30, 30) //Math.random() * window.innerWidth, Math.random() * window.innerHeight)\n    }\n    this.letter_map = letter_map\n  }\n  randomColour() {\n    const colours = [\"#9C2E23\", \"#C5A02F\", \"#002F6B\", \"#3D6F24\",'#cc00ff']\n    return colours[Math.floor(Math.random() * colours.length)];\n  }\n  moveLetter(id, position) {\n    try {\n      let letter = this.letter_map[id]\n      letter.position(position.x,position.y)\n    } catch (e) {\n      console.log(e)\n    }\n  }\n}\n\nclass Letter {\n  constructor(stage, id, char, x, y, onDrag, onDragStop, colour) {\n    let container = new PIXI.Container()\n    let text = new PIXI.Text(char, { font: '22px rounds_blackregular', fill: colour, align: 'left' })\n    container.addChild(text)\n    container.interactive = true\n    container.buttonMode = true\n    text.anchor.set(0.5)\n    this.id = id\n    let de = this.onDragEnd.bind(this)\n    let ds = this.onDragStart.bind(this)\n    let dm = this.onDragMove.bind(this)\n    container\n      // events for drag start\n      .on('mousedown', ds)\n      .on('touchstart', ds)\n      // events for drag end\n      .on('mouseup', de)\n      .on('mouseupoutside', de)\n      .on('touchend', de)\n      .on('touchendoutside', de)\n      // events for drag move\n      .on('mousemove', dm)\n      .on('touchmove', dm)\n    container.position.x = x\n    container.position.y = y\n    this.letter = container\n    stage.addChild(container)\n    this.broadcastDrag = onDrag\n    this.broadcastDragStop = onDragStop\n  }\n  position(x, y) {\n    // console.log(\"set position: \", x, y);\n    this.letter.position.x = x\n    this.letter.position.y = y\n  }\n  onDragStart(event) {\n    // store a reference to the data\n    // the reason for this is because of multitouch\n    // we want to track the movement of this particular touch\n    event.target.data = event.data\n    event.target.alpha = 0.5\n    event.target.dragging = true\n  }\n  onDragEnd(event){\n    event.target.alpha = 1\n    event.target.dragging = false\n    // set the interaction data to null\n    event.target.data = null\n    // TODO: Fix this with a js pub/sub solution\n    // Here is a great one http://davidwalsh.name/pubsub-javascript\n    this.broadcastDragStop()\n  }\n  onDragMove(event){\n    if (event.target.dragging){\n      var newPosition = event.target.data.getLocalPosition(event.target.parent)\n      event.target.position.x = newPosition.x\n      event.target.position.y = newPosition.y\n      this.broadcastDrag(this.id,newPosition.x,newPosition.y)\n    }\n  }\n}\n\n$( () => App.loadFonts() )\n\nexport default App\n"]}